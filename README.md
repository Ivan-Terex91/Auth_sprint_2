[Вход через facebook](https://github.com/smdnv/Auth_sprint_2/pull/5)
1. Добавлена модель для хранения oauth аккаунтов пользователей
2. Добавлена возможность войти через facebook
3. Добавлены api методы для просмотра и удаления oauth аккаунтов

[Управление доступами](https://github.com/smdnv/Auth_sprint_2/pull/4)
1. Добавлены модели ролей, прав и их связи с моделью пользователя.
2. Добавлена загрузка данных в модели ролей и прав.
3. Добавлены api методы для просмотра, добавления и удаления ролей пользователя.
4. Добавлены декораторы проверки прав пользователя и проверки является ли пользователь суперпользователем.
5. Добавлена проверка авторизации пользователя в сервис фильмов.
6. Добавлена проверка совершеннолетия пользователя в сервис фильмов.

[Управление доступами после ревью](https://github.com/smdnv/Auth_sprint_2/pull/6)

[Капча](https://github.com/smdnv/Auth_sprint_2/pull/7)
1. Добавлена модель для хранения сгенерированной капчи
2. Добавлена api методы для создания новой капчи, получения картинки, проверки результата
3. Добавлена обязательная капча для метода регистрации нового пользователя

# Запуск проекта
1. Конфигурация маппинга портов для локального запуска
```
cp docker-compose.override.yml{.example,}
```
2. Переменные окружения для запуска
```
cp .env{.example,}
```
3. Запуск контейнеров
```
docker-compose up -d
```

* В проекте находится тестовая бд, которая автоматически разворачивается в контейнере с postgres.
* Etl создаст нужные индексы в elastic и скопирует данные, после запуска elastic контейнера.
```
docker-compose logs -f --tail 30 etl
```
для просмотра процесса синхронизации данных.


# Auth
При запуске контейнера auth создаются все нужные таблицы для моделей. Если нужно пересоздать таблицу, то нужно зайти в контейнер в pg, удалить все старые таблицы и перезапустить контейнер с auth сервисом

# Swagger
http://localhost:8001/

В сваггере можно проверить работоспособность всех методов.
1. `/api/v1/auth/signup/` - Создание пользователя, метод создает только пользователя, получить токены можно отдельным запросом в login
2. `/api/v1/auth/login/` - Вход по логину и паролю, возвращает пару access, refresh токенов. После получения токенов, можно добавить access токен в механизм авторизации сваггера, который доступен на странице сверху. После этого сваггер автоматически будет отправлять токен в запросе.
3. `/api/v1/profile/` - Запрос данных пользователя, как пример api метода, который доступен только залогиненному пользователю.


# Проектная работа 7 спринта

Задания на спринт вы найдёте внутри тем.
